import openai
import os
from dotenv import load_dotenv
from openai import OpenAI

load_dotenv()

client = OpenAI(
    api_key=os.getenv('OPENAI_API_KEY')
)

def generate_email(startup_name, startup_description):
    # Craft the prompt
    prompt = f"""
        Ти агент з формулювання електронних листів.
        Ми студенти Університету прикладних наук Білефельда і маємо командний проект, для якого нам потрібно знайти кілька стартапів, портфоліо яких ми могли б продемонструвати. Напишіть стартапам електронного листа, щоб запитати, чи хочуть вони взяти участь у проекті. Нам потрібно зібрати демонстраційні джерела їхніх стартапів і створити для них односторінковий сайт з цими даними, а також продемонструвати стартап у нашій презентації. 

        Це приклад імейлу:
        [Шановні [Назва стартапу/Команда],

        Сподіваюсь, цей лист знаходить Вас у доброму здоров'ї.

        Ми – команда студентів з Університету прикладних наук Білефельда, яка працює над проектом, спрямованим на висвітлення інноваційних стартапів, таких як ваш. Наша мета – зібрати інформацію про перспективні стартапи, створити короткі профілі на одній сторінці та представити їх як частину нашого проекту.

        Ми впевнені, що Ваша участь буде взаємовигідною. Представляючи Ваш стартап у нашому проекті, ви зможете:

        - Вийти на німецький ринок: Розширити свою аудиторію та встановити контакти з потенційними клієнтами та партнерами в Німеччині.
        - Збільшити впізнаваність вашого бренду: Підвищити видимість через наші презентації та матеріали.
        - Потрапити до списку популярних стартапів Європи: Зміцнити вашу репутацію, будучи представленими поруч з іншими відомими стартапами.
        - Отримати вигідний маркетинг: Отримати додаткову рекламу без жодних фінансових витрат.
        - Досягти студентської аудиторії в Німеччині: Отримати доступ до пулу мотивованих потенційних співробітників з нашої університетської спільноти.
        Усе це – безкоштовно для Вас!

        Якщо Вас зацікавила ця можливість, будь ласка, надайте відповідь на цей лист протягом наступних трьох тижнів, щоб ми могли обговорити деталі. Ми надішлемо вам приклади того, що ви отримаєте в кінці, і якщо Вас влаштує, Ви зможете надати дані, які хочете представити, наприклад короткий опис вашої компанії, фотографії чи відео, маркетингові матеріали, тощо.

        Дякуємо за розгляд цієї співпраці. З нетерпінням чекаємо на можливість працювати з Вами.
        [на цьому місці важлива - пуста лінія для відділу кінця]
        З найкращими побажаннями,"

        Не додавай ім'я в кінці, останнє речення має бути "З найкращими побажаннями,]

        Зміни цей імейл щоб він краще підходив під опис стартапу: {startup_name}, {startup_description}.

        Ти маєш назвати 4 з 5 переваг і додати перевагу яка має значення саме для описаного стартапу.
    """
    
    response = client.chat.completions.create(
        model="gpt-4",
        messages=[
            {"role": "system", "content": "You are a helpful assistant for drafting emails."},
            {"role": "user", "content": prompt}
        ],
        max_tokens=1500,
        temperature=0.5
    )

    email_body = response.choices[0].message.content.strip()

    return email_body